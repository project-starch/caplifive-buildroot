#!/bin/sh

total_num=50

count_write_a=10
count_write_b=5
count_write_c=5
count_read=30

random() {
  echo $(($RANDOM % $1))
}

echo "Starting benchmark"

for i in $(seq 1 $count_write_a); do
  random_num=$(random $total_num)
  echo "random_num: $random_num"
  eval "command_$random_num=\"echo 'this_is_a_normal_test' | dd of=/dev/nullb0 bs=1024 count=10\""
done

for i in $(seq 1 $count_write_b); do
  random_num=$(random $total_num)
  echo "random_num: $random_num"
  eval "command_$random_num=\"echo 'this_is_a_long_long_long_long_long_long_long_test' | dd of=/dev/nullb0 bs=1024 count=10\""
done

for i in $(seq 1 $count_write_c); do
  random_num=$(random $total_num)
  echo "random_num: $random_num"
  eval "command_$random_num=\"echo 'test' | dd of=/dev/nullb0 bs=1024 count=10\""
done

for i in $(seq 1 $count_read); do
  random_num=$(random $total_num)
  echo "random_num: $random_num"
  eval "command_$random_num=\"dd if=/dev/nullb0 bs=1024 count=10\""
done

for i in $(seq 0 $((total_num - 1))); do
  if eval "[ -n \"\${command_$i}\" ]"; then
    echo "Executing $i: $(eval "echo \"\$command_$i\"")"
    eval "$(eval "echo \"\$command_$i\"")"
  fi
done
